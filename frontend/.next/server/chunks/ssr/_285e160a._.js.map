{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/BSC%20Agripreneur/agri-store/frontend/src/app/cart/page.js"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { useAuth } from '@/context/AuthContext';\nimport Link from 'next/link';\nimport Image from 'next/image';\nimport { useRouter } from 'next/navigation';\nimport { FaImage } from 'react-icons/fa';\n\nexport default function CartPage() {\n    const { user } = useAuth();\n    const router = useRouter();\n    const [cart, setCart] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [processing, setProcessing] = useState(false);\n\n    const fetchCart = useCallback(async () => {\n        if (!user) {\n            setLoading(false);\n            return;\n        }\n\n        setLoading(true);\n        try {\n            const res = await fetch('http://localhost:5000/api/cart', {\n                headers: { 'Authorization': `Bearer ${user.token}` }\n            });\n\n            if (res.status === 404) {\n                setCart({ products: [] });\n                return;\n            }\n            if (!res.ok) {\n                throw new Error('Failed to fetch cart');\n            }\n            const data = await res.json();\n            setCart(data);\n        } catch (error) {\n            console.error(\"Failed to fetch cart:\", error);\n            setCart(null);\n        } finally {\n            setLoading(false);\n        }\n    }, [user]);\n\n    useEffect(() => {\n        fetchCart();\n    }, [fetchCart]);\n\n    const handleRemoveItem = async (productId) => {\n        if (!user) return;\n        try {\n            const res = await fetch(`http://localhost:5000/api/cart/remove/${productId}`, {\n                method: 'DELETE',\n                headers: {\n                    'Authorization': `Bearer ${user.token}`\n                }\n            });\n            if (!res.ok) throw new Error('Failed to remove item');\n            fetchCart();\n        } catch (error) {\n            console.error(\"Failed to remove item:\", error);\n            alert('Error removing item from cart.');\n        }\n    };\n\n    const handleCheckout = async () => {\n        if (!user) return;\n        setProcessing(true);\n        try {\n            const res = await fetch(`http://localhost:5000/api/orders/checkout`, {\n                method: 'POST',\n                headers: {\n                    'Authorization': `Bearer ${user.token}`\n                }\n            });\n            if (!res.ok) throw new Error('Failed to place order');\n\n            alert('Order placed successfully!');\n            router.push('/orders');\n        } catch (error) {\n            console.error(\"Checkout failed:\", error);\n            alert('Error placing order.');\n        } finally {\n            setProcessing(false);\n        }\n    };\n\n    const calculateSubtotal = () => {\n        if (!cart || !cart.products) return '0.00';\n        return cart.products.reduce((total, item) => {\n            if (item.product) {\n                return total + item.product.price * item.quantity;\n            }\n            return total;\n        }, 0).toFixed(2);\n    };\n\n    if (loading) {\n        return <p className=\"text-center py-24 text-xl font-semibold\">Loading your cart...</p>;\n    }\n\n    if (!user) {\n        return <p className=\"text-center py-24 text-xl font-semibold\">\n            Please <Link href=\"/login\" className=\"text-green-600 underline hover:text-green-700\">log in</Link> to view your cart.\n        </p>;\n    }\n\n    if (!cart || cart.products.length === 0) {\n        return <p className=\"text-center py-24 text-xl font-semibold\">Your cart is empty.</p>;\n    }\n\n    return (\n        <div className=\"container mx-auto py-12 px-4\">\n            <h1 className=\"text-3xl font-bold mb-8\">Your Shopping Cart</h1>\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n                <div className=\"lg:col-span-2 space-y-4\">\n                    {cart.products.map(item => (\n                        item.product && (\n                            <div key={item.product._id} className=\"flex items-center justify-between p-4 border rounded-lg shadow-sm bg-white hover:shadow-md transition\">\n                                <div className=\"flex items-center space-x-4\">\n                                    {item.product.mainImage ? (\n                                        <Image src={item.product.mainImage} alt={item.product.name} width={80} height={80} className=\"rounded object-cover\" />\n                                    ) : (\n                                        <div className=\"w-20 h-20 bg-gray-200 flex items-center justify-center rounded\">\n                                            <FaImage className=\"text-gray-400\" size={24} />\n                                        </div>\n                                    )}\n                                    <div>\n                                        <h2 className=\"font-semibold text-gray-900\">{item.product.name}</h2>\n                                        <p className=\"text-gray-600\">₹{item.product.price.toFixed(2)}</p>\n                                    </div>\n                                </div>\n                                <div className=\"flex items-center space-x-4\">\n                                    <p className=\"text-gray-700\">Qty: {item.quantity}</p>\n                                    <button\n                                        onClick={() => handleRemoveItem(item.product._id)}\n                                        className=\"text-red-500 hover:text-red-700 font-semibold transition\"\n                                    >\n                                        Remove\n                                    </button>\n                                </div>\n                            </div>\n                        )\n                    ))}\n                </div>\n                <div className=\"bg-gray-50 p-6 rounded-lg self-start shadow-sm\">\n                    <h2 className=\"text-xl font-bold mb-4\">Order Summary</h2>\n                    <div className=\"flex justify-between mb-2 text-gray-700\">\n                        <span>Subtotal</span>\n                        <span>₹{calculateSubtotal()}</span>\n                    </div>\n                    <div className=\"flex justify-between font-bold text-lg border-t pt-2 mt-2 text-gray-900\">\n                        <span>Total</span>\n                        <span>₹{calculateSubtotal()}</span>\n                    </div>\n                    <button\n                        onClick={handleCheckout}\n                        disabled={processing}\n                        className={`w-full mt-6 py-2 rounded-lg font-bold transition \n                            ${processing ? \"bg-green-400 cursor-not-allowed\" : \"bg-green-600 hover:bg-green-700\"} text-white`}\n                    >\n                        {processing ? \"Processing...\" : \"Proceed to Checkout\"}\n                    </button>\n                </div>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 369, "column": 0}, "map": {"version":3,"sources":["file:///D:/BSC%20Agripreneur/agri-store/frontend/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0],"debugId":null}}]
}